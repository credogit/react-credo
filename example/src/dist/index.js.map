{"version":3,"file":"index.js","sources":["../../../libs/credo-script.ts","../../../libs/use-credo.ts"],"sourcesContent":["// noinspection JSUnresolvedReference\n\nimport {useState, useEffect} from 'react';\n\ninterface IScriptResult {\n  loaded: boolean;\n  error: boolean;\n}\n\nexport default function useCredoScript(): boolean[] {\n\n  const src = 'https://pay.credocentral.com/inline.js';\n\n  const [state, setState] = useState<IScriptResult>({\n    loaded: false,\n    error: false,\n  });\n\n  useEffect((): any => {\n\n    // @ts-ignore\n    if (document.getElementById(\"credo-inline\")) {\n      setState({\n        loaded: true,\n        error: false,\n      });\n    } else {\n\n      // @ts-ignore\n      const script = document.createElement('script');\n      script.src = src;\n      script.async = true;\n      script.id = 'credo-inline'\n\n      const onScriptLoad = (): void => {\n        setState({\n          loaded: true,\n          error: false,\n        });\n      };\n\n      const onScriptError = (): void => {\n        script.remove();\n        setState({\n          loaded: true,\n          error: true,\n        });\n      };\n\n      script.addEventListener('load', onScriptLoad);\n      script.addEventListener('complete', onScriptLoad);\n      script.addEventListener('error', onScriptError);\n\n      // @ts-ignore\n      document.body.appendChild(script);\n\n      return (): void => {\n        script.removeEventListener('load', onScriptLoad);\n        script.removeEventListener('error', onScriptError);\n      };\n    }\n  }, [src, setState]);\n\n  return [state.loaded, state.error];\n}\n","import {useEffect} from 'react';\nimport {InitializePayment, PaymentProps} from './types';\nimport useCredoScript from './credo-script';\n\nexport default function useCredoPayment(config: PaymentProps): InitializePayment {\n\n  const [scriptLoaded, scriptError] = useCredoScript();\n\n  function initializePayment(): void {\n    if (scriptError) {\n      throw new Error('Unable to load credo inline script');\n    }\n\n\n    if (scriptLoaded) {\n      const handler = (window as any).CredoWidget && (window as any).CredoWidget.setup(config);\n      if (handler) {\n        handler.openIframe();\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (scriptError) {\n      throw new Error('Unable to load credo inline script');\n    }\n  }, [scriptError]);\n\n  return initializePayment;\n}\n"],"names":["useState","useEffect"],"mappings":";;;;AAAA;AASc,SAAU,cAAc,GAAA;IAEpC,IAAM,GAAG,GAAG,wCAAwC,CAAC;IAE/C,IAAA,EAAA,GAAoBA,cAAQ,CAAgB;AAChD,QAAA,MAAM,EAAE,KAAK;AACb,QAAA,KAAK,EAAE,KAAK;AACb,KAAA,CAAC,EAHK,KAAK,GAAA,EAAA,CAAA,CAAA,CAAA,EAAE,QAAQ,QAGpB,CAAC;AAEH,IAAAC,eAAS,CAAC,YAAA;;AAGR,QAAA,IAAI,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE;AAC3C,YAAA,QAAQ,CAAC;AACP,gBAAA,MAAM,EAAE,IAAI;AACZ,gBAAA,KAAK,EAAE,KAAK;AACb,aAAA,CAAC,CAAC;SACJ;aAAM;;YAGL,IAAM,QAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAChD,YAAA,QAAM,CAAC,GAAG,GAAG,GAAG,CAAC;AACjB,YAAA,QAAM,CAAC,KAAK,GAAG,IAAI,CAAC;AACpB,YAAA,QAAM,CAAC,EAAE,GAAG,cAAc,CAAA;AAE1B,YAAA,IAAM,cAAY,GAAG,YAAA;AACnB,gBAAA,QAAQ,CAAC;AACP,oBAAA,MAAM,EAAE,IAAI;AACZ,oBAAA,KAAK,EAAE,KAAK;AACb,iBAAA,CAAC,CAAC;AACL,aAAC,CAAC;AAEF,YAAA,IAAM,eAAa,GAAG,YAAA;gBACpB,QAAM,CAAC,MAAM,EAAE,CAAC;AAChB,gBAAA,QAAQ,CAAC;AACP,oBAAA,MAAM,EAAE,IAAI;AACZ,oBAAA,KAAK,EAAE,IAAI;AACZ,iBAAA,CAAC,CAAC;AACL,aAAC,CAAC;AAEF,YAAA,QAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,cAAY,CAAC,CAAC;AAC9C,YAAA,QAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,cAAY,CAAC,CAAC;AAClD,YAAA,QAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,eAAa,CAAC,CAAC;;AAGhD,YAAA,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAM,CAAC,CAAC;YAElC,OAAO,YAAA;AACL,gBAAA,QAAM,CAAC,mBAAmB,CAAC,MAAM,EAAE,cAAY,CAAC,CAAC;AACjD,gBAAA,QAAM,CAAC,mBAAmB,CAAC,OAAO,EAAE,eAAa,CAAC,CAAC;AACrD,aAAC,CAAC;SACH;AACH,KAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;IAEpB,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;AACrC;;AC5DwB,SAAA,eAAe,CAAC,MAAoB,EAAA;IAEpD,IAAA,EAAA,GAA8B,cAAc,EAAE,EAA7C,YAAY,GAAA,EAAA,CAAA,CAAA,CAAA,EAAE,WAAW,GAAA,EAAA,CAAA,CAAA,CAAoB,CAAC;AAErD,IAAA,SAAS,iBAAiB,GAAA;QACxB,IAAI,WAAW,EAAE;AACf,YAAA,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;SACvD;QAGD,IAAI,YAAY,EAAE;AAChB,YAAA,IAAM,OAAO,GAAI,MAAc,CAAC,WAAW,IAAK,MAAc,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACzF,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,UAAU,EAAE,CAAC;aACtB;SACF;KACF;AAED,IAAAA,eAAS,CAAC,YAAA;QACR,IAAI,WAAW,EAAE;AACf,YAAA,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;SACvD;AACH,KAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;AAElB,IAAA,OAAO,iBAAiB,CAAC;AAC3B;;;;"}