{"version":3,"file":"index.js","sources":["../../../libs/credo-script.ts","../../../libs/use-credo.ts"],"sourcesContent":["import {useState, useEffect} from 'react';\n\ninterface ScriptResult {\n  loaded: boolean;\n  error: boolean;\n}\n\nexport default function useCredoScript(\n  src: string = 'https://pay.credocentral.com/inline.js',\n): [boolean, boolean] {\n  const [state, setState] = useState<ScriptResult>({loaded: false, error: false});\n\n  useEffect(() => {\n    if (document.getElementById('credo-inline')) {\n      setState({loaded: true, error: false});\n      return;\n    }\n\n    const script = document.createElement('script');\n    script.src = src;\n    script.async = true;\n    script.id = 'credo-inline';\n\n    const onScriptLoad = (): void => setState({loaded: true, error: false});\n    const onScriptError = (): void => {\n      script.remove();\n      setState({loaded: true, error: true});\n    };\n\n    script.addEventListener('load', onScriptLoad);\n    script.addEventListener('error', onScriptError);\n\n    document.body.appendChild(script);\n\n    return () => {\n      script.removeEventListener('load', onScriptLoad);\n      script.removeEventListener('error', onScriptError);\n    };\n  }, [src]);\n\n  return [state.loaded, state.error];\n}\n","import {useEffect, useCallback} from 'react';\nimport {InitializePayment, PaymentProps} from './types';\nimport useCredoScript from './credo-script';\n\nexport default function useCredoPayment(config: PaymentProps): InitializePayment {\n  const [scriptLoaded, scriptError] = useCredoScript();\n\n  const initializePayment = useCallback((): void => {\n    if (scriptError) {\n      throw new Error('Unable to load credo inline script');\n    }\n\n    if (scriptLoaded) {\n      const {CredoWidget} = window as any;\n      if (CredoWidget) {\n        const {setup} = CredoWidget;\n        const handler = setup(config);\n        if (handler) {\n          const {openIframe} = handler;\n          openIframe();\n        }\n      }\n    }\n  }, [scriptLoaded, scriptError, config]);\n\n  useEffect(() => {\n    if (scriptError) {\n      throw new Error('Unable to load credo inline script');\n    }\n  }, [scriptError]);\n\n  return initializePayment;\n}\n"],"names":["useState","useEffect","useCallback"],"mappings":"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"}